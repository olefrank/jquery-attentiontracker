(function(a){a.fn.attentionTracker=function(d){var c=this;var f=a.extend({pctInView:50,scrollByThresholdMs:1000,scrollThrottleMs:150,scrolldepthEventPrefix:"le_sd",totaltimeEventPrefix:"le_tt",trackTotalTime:true,heartbeatIntervalMs:2000,stop_heartbeat_after_ms:18000,eventCallback:function(i){h(i)},logCallback:function(i){g(i)}},d);var e=0,b=-1;return this.each(function(){window.onload=function(){t();if(s()){if(!m){w()}}k()};window.onscroll=function(){clearTimeout(I);I=setTimeout(function(){t();k();if(f.trackTotalTime){if(s()){if(!o){H();o=true}if(!m){w()}}else{if(m){A()}if(o){clearInterval(L);o=false}}}},f.scrollThrottleMs)};window.onbeforeunload=function(P){if(m){A()}clearTimeout(I);clearInterval(L);if(f.trackTotalTime){var O="total time in view: "+e;f.eventCallback(O)}};var l=a(this),i=l.offset().top,u=i+l.outerHeight(true),M=u-((u-i)/2),B=l.height(),E,v,D,x,N,q=0,m=false,I,j,G,C,p="",o=false,L,r=0,F=false,J=false,z=false,n=false,K=false,y=false;function H(){var O,R,Q=0,P;if(r===0){P=f.totaltimeEventPrefix+"_"+r+"="+Q;f.eventCallback(P)}L=setInterval(function(){r++;O=new Date();R=O.getTime()-x.getTime();if(R>f.scrollByThresholdMs){Q=e+R;P=f.totaltimeEventPrefix+"_"+r+"="+Q;f.eventCallback(P)}},f.heartbeatIntervalMs)}function t(){E=a(window).scrollTop();v=E+a(window).height();D=v-E}function k(){if(v>=i&&b<1){var O=(v-i)/B;if(O>b){b=O>1?1:O;G=new Date();if(typeof j==="undefined"){j=new Date()}C=(G.getTime()-j.getTime());if(!F&&b>=0){j=new Date();p+=f.scrolldepthEventPrefix+"_0="+C;F=true}if(!J&&b>=0.2){if(p.length>0){p+="&"}p+=f.scrolldepthEventPrefix+"_20="+C;J=true}if(!z&&b>=0.4){if(p.length>0){p+="&"}p+=f.scrolldepthEventPrefix+"_40="+C;z=true}if(!n&&b>=0.6){if(p.length>0){p+="&"}p+=f.scrolldepthEventPrefix+"_60="+C;n=true}if(!K&&b>=0.8){if(p.length>0){p+="&"}p+=f.scrolldepthEventPrefix+"_80="+C;K=true}if(!y&&b>=1){if(p.length>0){p+="&"}p+=f.scrolldepthEventPrefix+"_100="+C;y=true}if(p.length>0){f.eventCallback(p);p=""}}}}function s(){var P,O=D*(f.pctInView/100);if(E<=M){P=v-i}else{P=u-E}return P>=O}function w(){x=new Date();m=true}function A(){N=new Date();m=false;q=N.getTime()-x.getTime();if(q>f.scrollByThresholdMs){e+=q}}});function h(i){console.log("simulate event send: "+i)}function g(i){console.log("simulate log message: "+i)}}}(jQuery));